<h2>DESCRIPTION</h2>

<em>r.population.density</em> creates a weighting layer to be used for redistribution of population count known at some administrative unit level into a raster grid with a finest spatial resolution <em><a href="https://en.wikipedia.org/wiki/Dasymetric_map">(dasymetric mapping)</a></em>. The add-on trains a Random Forest (regression) model at the level of administrative units and predict a weight in a raster grid. The spatial resolution of this raster should be specified via the <b>tile_size</b> parameter, and its name via the <b>output</b> parameter.

<p> Random Forest's explanatory variables (i.e. covariates, predictors) are essentially the proportion of each class of a land cover map (<b>land_cover</b> parameter). Optionally, other variables can be added to the model. It includes proportion of any other raster's class (like land use map...) passed through the <b>raster</b> parameter, and/or a raster of distance to the nearest point of interest (e.g. distance to the nearest road, school, hospital, university...) passed through the <b>distance_to</b> parameter.

<p> The administrative units should be provided as a vector layer using the <b>vector</b> parameter. Regarding to the attribute table connected to this vector layer, a column containing a unique identifier should be specified via the <b>id</b> parameter and the column containing the value to be used as response variable (population count or any other response variable) via the <b>population</b> parameter.

<p> It is possible not to use all the classes whether for the land cover map or for the optional raster. For that purpose, a list of classes to be used should be specified via the <b>lc_list</b> parameter (for land cover map) or the <b>raster_list</b> parameter (for an additional map).

<p> The <em><a href="https://en.wikipedia.org/wiki/Out-of-bag_error">out-of-bag error</a></em> of the model is printed in the console and give an indication about the internal accuracy of the model (cross-validation on training set at the administrative units level). Features importance in the model are ploted in a graph, whose name have to be specified via the <b>plot</b> parameter.

<p> The add-on support parallel processing. The number of cores to be used should be specified via the <b>n_jobs</b> parameter. 


<h2>NOTES</h2>

<p> As the model is trained to predict the napierian logarithm of the response variable, it is mandatory to not have zero or negative values in the column containing the response variable. It is also expected that the response variable column does not contain <em>NULL</em> values. For the same reason, the model is unable to predict a zero weight value. The implementation of the add-on is designed so that if a predicted weight is smaller than 0.0000000001 obs./m² the value in the weighting layer will be set to 0. It is possible to force weighting layer's grids with a value of zero if a specific class (specified via the <b>built_up_category</b> parameter) is absent in those grids.

<h2>DEPENDENCIES</h2>
<p> TODO: Add list of Python libraries dependencies and instruction about how to install them in the GRASS GIS's Python
  
<h2>EXAMPLE</h2>

<div class="code"><pre>
# Generate a weighting layer using land cover map
r.population.density.py vector=admin_level_4 land_cover=my_landcover_map tile_size=100 id=CAT population=pop_tot output=weighting_raster_100m plot=/home/user/importance_plot n_jobs=4

# Generate a weighting layer using land cover map and land use map
r.population.density.py vector=admin_level_4 land_cover=my_landcover_map raster=my_landuse_map tile_size=100 id=CAT population=pop_tot output=weighting_raster_100m plot=/home/user/importance_plot n_jobs=4

# Generate a weighting layer using land cover map, land use map and distance to nearest school
r.population.density.py vector=admin_level_4 land_cover=my_landcover_map raster=my_landuse_map distance_to=nearest_school tile_size=100 id=CAT population=pop_tot output=weighting_raster_100m plot=/home/user/importance_plot n_jobs=4

# Generate a weighting layer using only category 3,4 of land cover map, category 8,9 of land use map and distance to nearest school
r.population.density.py vector=admin_level_4 land_cover=my_landcover_map raster=my_landuse_map distance_to=nearest_school tile_size=100 id=CAT population=pop_tot output=weighting_raster_100m plot=/home/user/importance_plot lc_list=3,4 raster_list=8,9 n_jobs=4
</pre></div>

<center>
<div>
<div style="display: inline-block;"><img src="weight.png" border=0 ><br>
<i>Figure: weighting layer </i></div>

<div style="display: inline-block;"><img src="importances_plot.png" border=0 ><br>
<i>Figure: Feature importances </i></div>
</div>
</center>

<h2>REFERENCES</h2>

Stevens, Forrest R, Andrea E Gaughan, Catherine Linard, and Andrew J Tatem. 2015. 
“Disaggregating Census Data for Population Mapping Using Random Forests with Remotely-Sensed and Other Ancillary Data.” 
Plos One, February. <a href="https://doi.org/10.1371/journal.pone.0107042">https://doi.org/10.1371/journal.pone.0107042</a>

<h2>SEE ALSO</h2>
	
<em>
<a href="v.area.weigh.html">v.area.weigh</a>,
<a href="v.rast.stats.html">v.rast.stats</a>,
</em>
	
<h2>AUTHOR</h2>
	
	Safa FENNIA, Tais GRIPPA
</body>
</html>

